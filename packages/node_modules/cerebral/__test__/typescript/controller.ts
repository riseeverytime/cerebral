import * as React from 'react'
import { render } from 'react-dom'
import { Controller, ControllerClass, Signal } from '../..'
import Devtools from '../../devtools'
import { set } from '../../operators'
import { Container } from '@cerebral/react'
import Router from '@cerebral/router'
import { props, signal, state } from '../../tags'
import * as signals from './signals'
import { rootModule } from './modules'
import HttpProvider, {HttpProviderError} from '@cerebral/http'
declare var process: any

const router = Router({
  routes: [
    { path: '/', signal: 'foo' }
  ],
  query: true,
  onlyHash: true
})

const controller: ControllerClass = Controller(rootModule, {
  devtools: process.env.NODE_ENV === 'production'
    ? undefined
    : Devtools({
      host: 'localhost:8585',
      reconnect: true
    })
})

render(
  React.createElement(
    Container,
    { controller },
    React.createElement('div', null, 'Hello Cerebral')
  ),
  document.querySelector('#app')
)

const appName = controller.getState('app.name')
const appState = controller.getState()

const appSignal: Signal = controller.getSignal('appSignal')
appSignal()
