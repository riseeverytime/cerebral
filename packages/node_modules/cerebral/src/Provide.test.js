/* eslint-env mocha */
import { Controller, Module } from './'
import provide from './Provide'
import assert from 'assert'

describe('Provide', () => {
  it('should create a provider', done => {
    const rootModule = Module({
      provider: provide('test', { foo: 'bar' }),
      signals: {
        test: [
          ({ test }) => {
            assert.deepEqual(test, { foo: 'bar' })
            done()
          },
        ],
      },
    })
    const controller = Controller(rootModule)
    controller.getSignal('test')()
  })
  it('should allow function passed the context', done => {
    const rootModule = Module({
      provider: provide('test', context => ({
        controller: context.controller,
      })),
      signals: {
        test: [
          ({ test, controller }) => {
            assert.equal(test.controller, controller)
            done()
          },
        ],
      },
    })
    const controller = Controller(rootModule)
    controller.getSignal('test')()
  })
})
